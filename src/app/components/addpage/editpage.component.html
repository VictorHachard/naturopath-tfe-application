<section class="my-4 container">

  <form *ngIf="page" [formGroup]="editInnerPageForm">
    <div class="form-group">
      <label for="titlePage">Title:</label>
      <input type="text" class="form-control" formControlName="titlePage" id="titlePage" >
    </div>
    <div class="form-group">
      <label for="descriptionPage">Description:</label>
      <textarea id="descriptionPage" formControlName="descriptionPage" class="form-control"></textarea>
    </div>
    <div class="mb-3">
    <div *ngIf="page.innerPageList[page.innerPageList.length - 1].state === 'DRAFT'; else elseIfBlock">
      <button type="button" class="btn btn-primary mr-2" id="save" (click)="updateInnerPage()">Save Draft</button>
      <button type="button" class="btn btn-primary" id="validation" (click)="validationInnerPage()">Validation</button>
    </div>
    <ng-template #elseIfBlock>
      <div *ngIf="page.innerPageList[page.innerPageList.length - 1].state === 'VALIDATING'; else elseBlock">
        <div class="progress">
          <div class="progress-bar bg-success" role="progressbar" style="{{ 'width:' + (page.innerPageList[page.innerPageList.length - 1].favour * 20).toString() + '%' }}" aria-valuenow="{{ page.innerPageList[page.innerPageList.length - 1].favour * 20 }}" aria-valuemin="0" aria-valuemax="100">{{ page.innerPageList[page.innerPageList.length - 1].favour }}/5</div>
          <div class="progress-bar bg-danger" role="progressbar" style="{{ 'width:' + (page.innerPageList[page.innerPageList.length - 1].against * 20).toString() + '%' }}" aria-valuenow="{{ page.innerPageList[page.innerPageList.length - 1].against * 20 }}" aria-valuemin="0" aria-valuemax="100">{{ page.innerPageList[page.innerPageList.length - 1].against }}/5</div>
        </div>
        <button type="button" class="btn btn-primary" (click)="voteInnerPage(page.innerPageList[page.innerPageList.length - 1].id, 1)">Favour</button>
        <button type="button" class="btn btn-primary" (click)="voteInnerPage(page.innerPageList[page.innerPageList.length - 1].id, 0)">Against</button>
      </div>
    </ng-template>
    <ng-template #elseBlock>
      <div class="progress mb-2">
        <div class="progress-bar bg-success" role="progressbar" style="{{ 'width:' + (page.innerPageList[page.innerPageList.length - 1].favour * 20).toString() + '%' }}" aria-valuenow="{{ page.innerPageList[page.innerPageList.length - 1].favour * 20 }}" aria-valuemin="0" aria-valuemax="100">{{ page.innerPageList[page.innerPageList.length - 1].favour }}/5</div>
        <div class="progress-bar bg-danger" role="progressbar" style="{{ 'width:' + (page.innerPageList[page.innerPageList.length - 1].against * 20).toString() + '%' }}" aria-valuenow="{{ page.innerPageList[page.innerPageList.length - 1].against * 20 }}" aria-valuemin="0" aria-valuemax="100">{{ page.innerPageList[page.innerPageList.length - 1].against }}/5</div>
      </div>
      <button type="button" class="btn btn-primary" id="new" (click)="addInnerPage(page.innerPageList[page.innerPageList.length - 1].id, page.id)">New title/description</button>
    </ng-template>
    </div>
  </form>

  <div *ngIf="page && editInnerParagraphForm">
    <form [formGroup]="editInnerParagraphForm">
      <div *ngFor="let paragraph of page.paragraphList">
        <h4 class="mb-4">Title: {{ paragraph.paragraphType.name + ' ' + paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].id}}</h4>
        <div class="form-group">
          <label for="title">Title:</label>
          <input type="text" class="form-control" id="title" formControlName="{{ 'titleParagraph' +  paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].id}}" value="{{ paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].title }}">
        </div>
        <div class="form-group">
          <label for="content">Content:</label>
          <textarea id="content" class="form-control" formControlName="{{ 'contentParagraph' +  paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].id}}" [value]="paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].content"></textarea>
        </div>
        <div class="mb-3">
          <div *ngIf="paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].state === 'DRAFT'; else elseIfBlock">
            <button type="button" class="btn btn-primary mr-2" (click)="updateInnerParagraph(paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].id)">Save Draft</button>
            <button type="button" class="btn btn-primary" (click)="validationInnerParagraph(paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].id)">Validation</button>
          </div>
          <ng-template #elseIfBlock>
            <div *ngIf="paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].state === 'VALIDATING'; else elseBlock">
              <div class="progress mb-2">
                <div class="progress-bar bg-success" role="progressbar" style="{{ 'width:' + (paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].favour * 20).toString() + '%' }}" aria-valuenow="{{ paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].favour * 20 }}" aria-valuemin="0" aria-valuemax="100">{{ paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].favour }}/5</div>
                <div class="progress-bar bg-danger" role="progressbar" style="{{ 'width:' + (paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].against * 20).toString() + '%' }}" aria-valuenow="{{ paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].against * 20 }}" aria-valuemin="0" aria-valuemax="100">{{ paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].against }}/5</div>
              </div>
              <button type="button" class="btn btn-primary" (click)="voteInnerParagraph(paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].id, 1)">Favour</button>
              <button type="button" class="btn btn-primary" (click)="voteInnerParagraph(paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].id, 0)">Against</button>
            </div>
          </ng-template>
          <ng-template #elseBlock>
            <div class="progress mb-2">
              <div class="progress-bar bg-success" role="progressbar" style="{{ 'width:' + (paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].favour * 20).toString() + '%' }}" aria-valuenow="{{ paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].favour * 20 }}" aria-valuemin="0" aria-valuemax="100">{{ paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].favour }}/5</div>
              <div class="progress-bar bg-danger" role="progressbar" style="{{ 'width:' + (paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].against * 20).toString() + '%' }}" aria-valuenow="{{ paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].against * 20 }}" aria-valuemin="0" aria-valuemax="100">{{ paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].against }}/5</div>
            </div>
            <button type="button" class="btn btn-primary" (click)="addInnerParagraph(paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].id, paragraph.id)">New title/description</button>
          </ng-template>
        </div>
      </div>
    </form>
  </div>

  <!--
  <div *ngIf="page">
    <form *ngFor="let paragraph of page.paragraphList" [formGroup]="editInnerParagraphForm">
      <h4 class="mb-4">Title: {{ paragraph.paragraphType.name + ' ' + paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].id}}</h4>
      <div class="form-group">
        <label for="title">Title:</label>
        <input type="text" class="form-control" id="title" formControlName="titleParagraph" value="{{ paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].title }}">
      </div>
      <div class="form-group">
        <label for="content">Content:</label>
        <textarea id="content" class="form-control" formControlName="contentParagraph" [value]="paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].content"></textarea>
      </div>
      <div class="mb-3">
        <div *ngIf="paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].state === 'DRAFT'; else elseIfBlock">
          <button type="button" class="btn btn-primary mr-2" id="save" (click)="updateInnerParagraph(paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].id)">Save Draft</button>
          <button type="button" class="btn btn-primary">Validation</button>
        </div>
        <ng-template #elseIfBlock>
          <div class="progress" *ngIf="paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].state === 'VALIDATING'; else elseBlock">
            <div class="progress-bar bg-success" role="progressbar" style="{{ 'width:' + (paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].favour * 20).toString() + '%' }}" aria-valuenow="{{ paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].favour * 20 }}" aria-valuemin="0" aria-valuemax="100">{{ paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].favour }}/5</div>
            <div class="progress-bar bg-danger" role="progressbar" style="{{ 'width:' + (paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].against * 20).toString() + '%' }}" aria-valuenow="{{ paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].against * 20 }}" aria-valuemin="0" aria-valuemax="100">{{ paragraph.innerParagraphList[paragraph.innerParagraphList.length - 1].against }}/5</div>
          </div>
        </ng-template>
        <ng-template #elseBlock>
          <button type="button" class="btn btn-primary">New title/description</button>
        </ng-template>
      </div>
    </form>
  </div>


  <form *ngFor="let paratag of page?.paratagList ">
    <h4 class="mb-4">Title: {{ paratag.paratagType.name }}</h4>
    <div class="form-group">
      <label for="titleParatag">Title:</label>
      <input type="text" class="form-control" id="titleParatag" value="{{ paratag.innerParatagList[paratag.innerParatagList.length - 1].title }}">
    </div>

    <div class="mb-3">
      <div *ngIf="paratag.innerParatagList[paratag.innerParatagList.length - 1].state === 'DRAFT'; else elseIfBlock">
        <button type="button" class="btn btn-primary mr-2">Save Draft</button>
        <button type="button" class="btn btn-primary">Validation</button>
      </div>
      <ng-template #elseIfBlock>
        <div class="progress" *ngIf="paratag.innerParatagList[paratag.innerParatagList.length - 1].state === 'VALIDATING'; else elseBlock">
          <div class="progress-bar bg-success" role="progressbar" style="{{ 'width:' + (paratag.innerParatagList[paratag.innerParatagList.length - 1].favour * 20).toString() + '%' }}" aria-valuenow="{{ paratag.innerParatagList[paratag.innerParatagList.length - 1].favour * 20 }}" aria-valuemin="0" aria-valuemax="100">{{ paratag.innerParatagList[paratag.innerParatagList.length - 1].favour }}/5</div>
          <div class="progress-bar bg-danger" role="progressbar" style="{{ 'width:' + (paratag.innerParatagList[paratag.innerParatagList.length - 1].against * 20).toString() + '%' }}" aria-valuenow="{{ paratag.innerParatagList[paratag.innerParatagList.length - 1].against * 20 }}" aria-valuemin="0" aria-valuemax="100">{{ paratag.innerParatagList[paratag.innerParatagList.length - 1].against }}/5</div>
        </div>
      </ng-template>
      <ng-template #elseBlock>
        <button type="button" class="btn btn-primary">New title/description</button>
      </ng-template>
    </div>
  </form>-->


</section>



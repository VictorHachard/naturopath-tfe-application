<section class="my-4 container">

  <form *ngIf="page" [formGroup]="editInnerPageForm">
    <div class="form-group">
      <label for="titlePage">Title:</label>
      <input type="text" class="form-control" formControlName="titlePage" id="titlePage" >
    </div>
    <div class="form-group">
      <label for="descriptionPage">Description:</label>
      <textarea id="descriptionPage" formControlName="descriptionPage" class="form-control"></textarea>
    </div>
    <div class="mb-3">
    <div *ngIf="page.innerPageList[page.innerPageList.length - 1].state === 'DRAFT'; else elseIfBlock">
      <button type="button" class="btn btn-primary mr-2" id="save" (click)="updateInnerPage()">Save Draft</button>
      <button type="button" class="btn btn-primary" id="validation" (click)="validationInnerPage()">Validation</button>
    </div>
    <ng-template #elseIfBlock>
      <div *ngIf="page.innerPageList[page.innerPageList.length - 1].state === 'VALIDATING'; else elseBlock">
        <div class="progress mb-2">
          <div class="progress-bar bg-success" role="progressbar" style="{{ 'width:' + (page.innerPageList[page.innerPageList.length - 1].favour * 20).toString() + '%' }}" aria-valuenow="{{ page.innerPageList[page.innerPageList.length - 1].favour * 20 }}" aria-valuemin="0" aria-valuemax="100">{{ page.innerPageList[page.innerPageList.length - 1].favour }}/5</div>
          <div class="progress-bar bg-danger" role="progressbar" style="{{ 'width:' + (page.innerPageList[page.innerPageList.length - 1].against * 20).toString() + '%' }}" aria-valuenow="{{ page.innerPageList[page.innerPageList.length - 1].against * 20 }}" aria-valuemin="0" aria-valuemax="100">{{ page.innerPageList[page.innerPageList.length - 1].against }}/5</div>
        </div>
        <button type="button" class="btn btn-primary mr-2" (click)="voteInnerPage(page.innerPageList[page.innerPageList.length - 1].id, 1)">Favour</button>
        <button type="button" class="btn btn-primary" (click)="voteInnerPage(page.innerPageList[page.innerPageList.length - 1].id, 0)">Against</button>
      </div>
    </ng-template>
    <ng-template #elseBlock>
      <div class="progress mb-2">
        <div class="progress-bar bg-success" role="progressbar" style="{{ 'width:' + (page.innerPageList[page.innerPageList.length - 1].favour * 20).toString() + '%' }}" aria-valuenow="{{ page.innerPageList[page.innerPageList.length - 1].favour * 20 }}" aria-valuemin="0" aria-valuemax="100">{{ page.innerPageList[page.innerPageList.length - 1].favour }}/5</div>
        <div class="progress-bar bg-danger" role="progressbar" style="{{ 'width:' + (page.innerPageList[page.innerPageList.length - 1].against * 20).toString() + '%' }}" aria-valuenow="{{ page.innerPageList[page.innerPageList.length - 1].against * 20 }}" aria-valuemin="0" aria-valuemax="100">{{ page.innerPageList[page.innerPageList.length - 1].against }}/5</div>
      </div>
      <button type="button" class="btn btn-primary" id="new" (click)="addInnerPage(page.innerPageList[page.innerPageList.length - 1].id, page.id)">New title/description</button>
    </ng-template>
    </div>
  </form>

  <div *ngIf="page && editInnerParagraphForm">

    <div *ngFor="let formGroup of editInnerParagraphForm; let index = index">
      <form [formGroup]="formGroup">
        <h4 class="mb-4">Title: {{ page.paragraphList[index].paragraphType.name + ' ' + page.paragraphList[index].innerParagraphList[page.paragraphList[index].innerParagraphList.length - 1].id}}</h4>
        <div class="form-group">
          <label for="title">Title:</label>
          <input type="text" class="form-control" id="title" formControlName="titleParagraph" value="{{ page.paragraphList[index].innerParagraphList[page.paragraphList[index].innerParagraphList.length - 1].title }}">
        </div>
        <div class="form-group">
          <label for="content">Content:</label>
          <textarea id="content" class="form-control" formControlName="contentParagraph" [value]="page.paragraphList[index].innerParagraphList[page.paragraphList[index].innerParagraphList.length - 1].content"></textarea>
        </div>
        <div class="mb-3">
          <div *ngIf="page.paragraphList[index].innerParagraphList[page.paragraphList[index].innerParagraphList.length - 1].state === 'DRAFT'; else elseIfBlock">
            <button type="button" class="btn btn-primary mr-2" (click)="updateInnerParagraph(index, page.paragraphList[index].innerParagraphList[page.paragraphList[index].innerParagraphList.length - 1].id)">Save Draft</button>
            <button type="button" class="btn btn-primary" (click)="validationInnerParagraph(index, page.paragraphList[index].innerParagraphList[page.paragraphList[index].innerParagraphList.length - 1].id)">Validation</button>
          </div>
          <ng-template #elseIfBlock>
            <div *ngIf="page.paragraphList[index].innerParagraphList[page.paragraphList[index].innerParagraphList.length - 1].state === 'VALIDATING'; else elseBlock">
              <div class="progress mb-2">
                <div class="progress-bar bg-success" role="progressbar" style="{{ 'width:' + (page.paragraphList[index].innerParagraphList[page.paragraphList[index].innerParagraphList.length - 1].favour * 20).toString() + '%' }}" aria-valuenow="{{ page.paragraphList[index].innerParagraphList[page.paragraphList[index].innerParagraphList.length - 1].favour * 20 }}" aria-valuemin="0" aria-valuemax="100">{{ page.paragraphList[index].innerParagraphList[page.paragraphList[index].innerParagraphList.length - 1].favour }}/5</div>
                <div class="progress-bar bg-danger" role="progressbar" style="{{ 'width:' + (page.paragraphList[index].innerParagraphList[page.paragraphList[index].innerParagraphList.length - 1].against * 20).toString() + '%' }}" aria-valuenow="{{ page.paragraphList[index].innerParagraphList[page.paragraphList[index].innerParagraphList.length - 1].against * 20 }}" aria-valuemin="0" aria-valuemax="100">{{ page.paragraphList[index].innerParagraphList[page.paragraphList[index].innerParagraphList.length - 1].against }}/5</div>
              </div>
              <button type="button" class="btn btn-primary mr-2" (click)="voteInnerParagraph(index, page.paragraphList[index].innerParagraphList[page.paragraphList[index].innerParagraphList.length - 1].id, 1)">Favour</button>
              <button type="button" class="btn btn-primary" (click)="voteInnerParagraph(index, page.paragraphList[index].innerParagraphList[page.paragraphList[index].innerParagraphList.length - 1].id, 0)">Against</button>
            </div>
          </ng-template>
          <ng-template #elseBlock>
            <div class="progress mb-2">
              <div class="progress-bar bg-success" role="progressbar" style="{{ 'width:' + (page.paragraphList[index].innerParagraphList[page.paragraphList[index].innerParagraphList.length - 1].favour * 20).toString() + '%' }}" aria-valuenow="{{ page.paragraphList[index].innerParagraphList[page.paragraphList[index].innerParagraphList.length - 1].favour * 20 }}" aria-valuemin="0" aria-valuemax="100">{{ page.paragraphList[index].innerParagraphList[page.paragraphList[index].innerParagraphList.length - 1].favour }}/5</div>
              <div class="progress-bar bg-danger" role="progressbar" style="{{ 'width:' + (page.paragraphList[index].innerParagraphList[page.paragraphList[index].innerParagraphList.length - 1].against * 20).toString() + '%' }}" aria-valuenow="{{ page.paragraphList[index].innerParagraphList[page.paragraphList[index].innerParagraphList.length - 1].against * 20 }}" aria-valuemin="0" aria-valuemax="100">{{ page.paragraphList[index].innerParagraphList[page.paragraphList[index].innerParagraphList.length - 1].against }}/5</div>
            </div>
            <button type="button" class="btn btn-primary" (click)="addInnerParagraph(index, page.paragraphList[index].innerParagraphList[page.paragraphList[index].innerParagraphList.length - 1].id, page.paragraphList[index].id)">New title/description</button>
          </ng-template>
        </div>
      </form>
    </div>
  </div>

  <div  *ngIf="page && allParaTagForm">


    <div *ngFor="let formGroup of allParaTagForm; let index = index">
      <form [formGroup]="formGroup">
        <h4 class="mb-4">Title: {{ page.paratagList[index].paratagType.name }}</h4>
        <div class="form-group">
          <label for="titleParatag">Title:</label>
          <input type="text" class="form-control" id="titleParaTag" formControlName="titleParaTag" value="{{ page.paratagList[index].innerParatagList[page.paratagList[index].innerParatagList.length - 1].title }}">
        </div>
        <div class="form-group">
          <label for="content">Content:</label>
          <textarea id="descriptionParaTag" class="form-control" formControlName="descriptionParaTag" [value]="page.paragraphList[index].innerParagraphList[page.paragraphList[index].innerParagraphList.length - 1].content"></textarea>
        </div>
           <div cdkDropListGroup>
         <div class="example-container">
           <h2>To do</h2>
           <div
             cdkDropList
             [cdkDropListData]="allTagTypeList"
             class="example-list"
             (cdkDropListDropped)="dropItem($event)">
             <div class="example-box" *ngFor="let item of allTagTypeList" cdkDrag>{{item}}</div>
           </div>
         </div>
         <div class="example-container">
           <h2>Done</h2>
           <div
             cdkDropList
             [cdkDropListData]="tagTypeListSend"
             class="example-list"
             (cdkDropListDropped)="dropItem($event)">
             <div class="example-box" *ngFor="let item of tagTypeListSend" cdkDrag>{{item}}</div>
           </div>
         </div>
       </div>
     <!-- <div class="mb-3">
          <div *ngIf="paratag.innerParatagList[paratag.innerParatagList.length - 1].state === 'DRAFT'; else elseIfBlock">
            <button type="button" class="btn btn-primary mr-2">Save Draft</button>
            <button type="button" class="btn btn-primary">Validation</button>
          </div>
          <ng-template #elseIfBlock>
            <div class="progress" *ngIf="paratag.innerParatagList[paratag.innerParatagList.length - 1].state === 'VALIDATING'; else elseBlock">
              <div class="progress-bar bg-success" role="progressbar" style="{{ 'width:' + (paratag.innerParatagList[paratag.innerParatagList.length - 1].favour * 20).toString() + '%' }}" aria-valuenow="{{ paratag.innerParatagList[paratag.innerParatagList.length - 1].favour * 20 }}" aria-valuemin="0" aria-valuemax="100">{{ paratag.innerParatagList[paratag.innerParatagList.length - 1].favour }}/5</div>
              <div class="progress-bar bg-danger" role="progressbar" style="{{ 'width:' + (paratag.innerParatagList[paratag.innerParatagList.length - 1].against * 20).toString() + '%' }}" aria-valuenow="{{ paratag.innerParatagList[paratag.innerParatagList.length - 1].against * 20 }}" aria-valuemin="0" aria-valuemax="100">{{ paratag.innerParatagList[paratag.innerParatagList.length - 1].against }}/5</div>
            </div>
          </ng-template>
          <ng-template #elseBlock>
            <button type="button" class="btn btn-primary">New title/description</button>
          </ng-template>
        </div>--->
       </form>
     </div>
   </div>

 </section>


